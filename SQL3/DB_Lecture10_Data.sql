CREATE DATABASE lecture10_project;

USE lecture10_project;

CREATE TABLE employee(
	EMPNO nvarchar(6) NOT NULL,
	FIRSTNAME nvarchar(255) NOT NULL,
	MIDINIT nvarchar(1) NOT NULL,
	LASTNAME nvarchar(255) NOT NULL,
	WORKDEPT nvarchar(3) NULL,
	PHONENO nvarchar(4) NULL,
	HIREDATE nvarchar(10) NULL,
	SALARY decimal(9, 2) NULL
);

INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000010', 'CHRISTINE', 'I', 'HAAS', 'A00', '3978', '1965-01-01', CAST(52750.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000020', 'MICHAEL', 'L', 'THOMPSON', 'B01', '3476', '1973-10-10', CAST(41250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000030', 'SALLY', 'A', 'KWAN', 'C01', '4738', '1975-05-04', CAST(38250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000050', 'JOH', 'B', 'GEYER', 'E01', '6789', '1949-08-17', CAST(40175.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000060', 'IRVING', 'F', 'STER', 'D11', '6423', '1973-09-14', CAST(32250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000070', 'EVA', 'D', 'PULASKI', 'D21', '7831', '1980-09-30', CAST(36170.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000090', 'EILEE', 'W', 'HENDERSON', 'E11', '5498', '1970-08-15', CAST(29750.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000100', 'THEODORE', 'Q', 'SPENSER', 'E21', '972 ', '1980-06-15', CAST(26150.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000110', 'VINCENZO', 'G', 'LUCCHESSI', 'A00', '3490', '1958-05-16', CAST(46500.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000120', 'SEA', 'S', 'OCONNELL', 'A00', '2167', '1963-05-12', CAST(29250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000130', 'DOLORES', 'M', 'QUINTANA', 'C01', '4578', '1971-07-28', CAST(23800.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000140', 'HEATHER', 'A', 'NICHOLLS', 'C01', '1793', '1976-12-15', CAST(28420.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000150', 'BRUCE', 'B', 'ADAMSON', 'D11', '4510', '1972-02-12', CAST(25280.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000160', 'ELIZABETH', 'R', 'PIANKA', 'D11', '3782', '1977-10-11', CAST(22250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000170', 'MASATOSHI', 'J', 'YOSHIMURA', 'D11', '2890', '1978-09-15', CAST(24680.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000180', 'MARILY', 'S', 'SCOUTTE', 'D11', '1682', '1973-07-07', CAST(21340.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000190', 'JAMES', 'H', 'WALKER', 'D11', '2986', '1974-07-26', CAST(20450.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000200', 'DAVID', 'D', 'BROWN', 'D11', '4501', '1966-03-03', CAST(27740.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000210', 'WILLIAM', 'T', 'JONES', 'D11', '942 ', '1979-04-11', CAST(18270.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000220', 'JENNIFER', 'K', 'LUTZ', 'D11', '672 ', '1968-08-29', CAST(29840.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000230', 'JAMES', 'J', 'JEFFERSON', 'D21', '2094', '1966-11-21', CAST(22180.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000240', 'SALVATORE', 'M', 'MARINO', 'D21', '3780', '1979-12-05', CAST(28760.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000250', 'DANIEL', 'S', 'SMITH', 'D21', '961 ', '1969-10-30', CAST(19180.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000260', 'SYBIL', 'P', 'JOHNSON', 'D21', '8953', '1975-09-11', CAST(17250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000270', 'MARIA', 'L', 'PEREZ', 'D21', '9001', '1980-09-30', CAST(27380.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000280', 'ETHEL', 'R', 'SCHNEIDER', 'E11', '8997', '1967-03-24', CAST(26250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000290', 'JOH', 'R', 'PARKER', 'E11', '4502', '1980-05-30', CAST(15340.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000300', 'PHILIP', 'X', 'SMITH', 'E11', '2095', '1972-06-19', CAST(17750.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000310', 'MAUDE', 'F', 'SETRIGHT', 'E11', '3332', '1964-09-12', CAST(15900.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000320', 'RAMLAL', 'V', 'MEHTA', 'E21', '9990', '1965-07-07', CAST(19950.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000330', 'WING', 'W', 'LEE', 'E21', '2103', '1976-02-23', CAST(25370.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('000340', 'JASO', 'R', 'GOUNOT', 'E21', '5698', '1947-05-05', CAST(23840.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200010', 'DIA', 'J', 'HEMMINGER', 'A00', '3978', '1965-01-01', CAST(46500.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200120', 'GREG', 'G', 'ORLANDO', 'A00', '2167', '1972-05-05', CAST(29250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200140', 'KIM', '', 'NATZ', 'C01', '1793', '1976-12-15', CAST(28420.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200170', 'KIYOSHI', 'K', 'YAMAMOTO', 'D11', '2890', '1978-09-15', CAST(24680.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200220', 'REBA', 'K', 'JOHN', 'D11', '672 ', '1968-08-29', CAST(29840.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200240', 'ROBERT', 'M', 'MONTEVERDEN', 'D21', '3780', '1979-12-05', CAST(28760.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200280', 'EILEE', 'R', 'SCHWARTZ', 'E11', '8997', '1967-03-24', CAST(26250.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200310', 'MICHELLE', 'F', 'SPRINGER', 'E11', '3332', '1964-09-12', CAST(15900.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200330', 'HELENA', 'H', 'WONG', 'E21', '2103', '1976-02-23', CAST(25370.00 AS Decimal(9, 2)));
INSERT employee (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, SALARY) VALUES ('200340', 'ROY', 'R', 'ALONZON', 'E21', '5698', '1947-05-05', CAST(23840.00 AS Decimal(9, 2)));

CREATE TABLE department2(
	DEPTNO nvarchar(3) NOT NULL,
	DEPTNAME nvarchar(255) NOT NULL,
	MGRNO nvarchar(6) NULL,
	ADMRDEPT nvarchar(3) NOT NULL
);

INSERT department2 (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('U00', 'SPIFFY COMPUTER SERVICE DIV.', '000010', 'A00');
INSERT department2 (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('V01', 'PLANNING', '000020', 'A00');
INSERT department2 (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('W01', 'INFORMATION CENTER', '000030', 'A00');
INSERT department2 (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('X01', 'DEVELOPMENT CENTER', NULL, 'A00');
INSERT department2 (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('D11', 'MANUFACTURING SYSTEMS', '000060', 'D01');

CREATE TABLE department(
	DEPTNO nvarchar(3) NOT NULL,
	DEPTNAME nvarchar(255) NOT NULL,
	MGRNO nvarchar(6) NULL,
	ADMRDEPT nvarchar(3) NOT NULL
);

INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('A00', 'SPIFFY COMPUTER SERVICE DIV.', '000010', 'A00');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('B01', 'PLANNING', '000020', 'A00');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('C01', 'INFORMATION CENTER', '000030', 'A00');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('D01', 'DEVELOPMENT CENTER', NULL, 'A00');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('D11', 'MANUFACTURING SYSTEMS', '000060', 'D01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('D21', 'ADMINISTRATION SYSTEMS', '000070', 'D01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('E01', 'SUPPORT SERVICES', '000050', 'A00');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('E11', 'OPERATIONS', '000090', 'E01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('E21', 'SOFTWARE SUPPORT', '000100', 'E01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('F22', 'BRANCH OFFICE F2', NULL, 'E01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('G22', 'BRANCH OFFICE G2', NULL, 'E01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('H22', 'BRANCH OFFICE H2', NULL, 'E01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('I22', 'BRANCH OFFICE I2', NULL, 'E01');
INSERT department (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT) VALUES ('J22', 'BRANCH OFFICE J2', NULL, 'E01');

CREATE TABLE project(
	PROJNO nvarchar(6) NOT NULL,
	PROJNAME nvarchar(255) NOT NULL,
	DEPTNO nvarchar(3) NOT NULL,
	RESPEMP nvarchar(6) NOT NULL,
	MAJPROJ nvarchar(6) NULL
);

INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('AD3100', 'ADMIN SERVICES', 'D01', '000010', '      ');
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('AD3110', 'GENERAL AD SYSTEM', 'D21', '000070', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('AD3111', 'PAYROLL PROGRAMMING', 'D21', '000230', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('AD3112', 'PERSONNEL PROGRAMMING', 'D21', '000250', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('AD3113', 'ACCOUNT. PROGRAMMING', 'D21', '000270', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('IF1000', 'QUERY SERVICES', 'C01', '000030', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('IF2000', 'USER EDUCATIO', 'C01', '000030', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('MA2100', 'WELD LINE AUTOMATIO', 'D01', '000010', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('MA2110', 'W L PROGRAMMING', 'D11', '000060', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('MA2111', 'W L PROGRAM DESIG', 'D11', '000220', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('MA2112', 'W L ROBOT DESIG', 'D11', '000150', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('MA2113', 'W L PROD CONT PROGS', 'D11', '000160', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP1000', 'OPERATION SUPPORT', 'E01', '000050', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP1010', 'OPERATIO', 'E11', '000090', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP2000', 'GEN SYSTEM SERVICES', 'E01', '000050', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP2010', 'SYSTEMS SUPPORT', 'E21', '000100', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP2011', 'SCP SYSTEMS SUPPORT', 'E21', '000320', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP2012', 'APPLICATIONS SUPPORT', 'E21', '000330', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('OP2013', 'DB/DC SUPPORT', 'E21', '000340', NULL);
INSERT project (PROJNO, PROJNAME, DEPTNO, RESPEMP, MAJPROJ) VALUES ('PL2100', 'WELD LINE PLANNING', 'B01', '000020', NULL);

create   view  ManufacturingProjects as
	(  select   projno, projname, firstname, lastname
	   from     project, employee
	   where  respemp = empno  and  deptno = 'D21'  );

